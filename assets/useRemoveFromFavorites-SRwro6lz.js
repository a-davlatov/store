import{_ as c,f as d,g as l,q as a,m as u,R as v,B as h,S as m,k as f,s as t,D as r,K as n}from"./index-BWaPwz3E.js";const g={class:"product__card relative sm:hover:shadow-2xl p-2 transition"},b={class:"product__card-img"},x=["src","alt"],y={key:0,class:"absolute top-0 left-0 bg-orange-500 p-2 rounded-full text-white font-medium"},_={class:"product-prompt absolute opacity-0 invisible transition top-5 right-12 text-xs text-white px-2 py-1 rounded bg-black/60"},$={class:"flex items-end gap-2"},A={key:0,class:"text-base text-slate-400 my-1 line-through"},k={class:"text-lg font-bold my-1"},F={class:"text-sm flex-1"},P={class:"mt-2 opacity-0 add-to-cart absolute z-20 bg-white start-0 end-0 p-2 transition"},p={__name:"ProductCard",props:{imageUrl:String,title:String,price:Number,oldPrice:Number,isAdded:Boolean,isFavorite:Boolean},setup(e){return(i,s)=>(d(),l("div",g,[a("div",b,[a("img",{src:e.imageUrl,alt:e.title},null,8,x),e.oldPrice?(d(),l("div",y," Sale ")):u("",!0),a("button",{class:"icon-heart absolute top-5 right-5 hover:text-orange-400 transition text-xl",onClick:s[0]||(s[0]=o=>e.isFavorite?i.$emit("removeFromFavorites"):i.$emit("addToFavorites"))},[a("i",{class:v(e.isFavorite?"bi bi-heart-fill text-red-500":"bi bi-heart")},null,2)]),h(a("div",_," Войдите сначала на сайт ",512),[[m,!f(t).signedIn]])]),a("div",$,[e.oldPrice?(d(),l("div",A,r(e.oldPrice)+" ₽ ",1)):u("",!0),a("div",k,r(e.price)+" ₽",1)]),a("div",F,r(e.title),1),a("div",P,[a("button",{class:"py-1 text-sm px-5 rounded hover:bg-gray-800 bg-black text-white transition w-full",onClick:s[1]||(s[1]=o=>i.$emit("onClickAdd"))},r(e.isAdded?"Добавить еще":"В корзину"),1)])]))}},D=c(p,[["__scopeId","data-v-daa27be8"]]);function I(e,i){if(i.find(o=>o.id===e.id)){i=i.map(o=>o.id===e.id?{...o,quantity:o.quantity+=1}:o);return}e.quantity=1,e.isAdded=!0,i.push(e)}function C(e){return n.post(`${t.API_URL}/favorites`,e,{headers:{Authorization:`Bearer ${t.userData.token}`}})}function B(e){return n.delete(`${t.API_URL}/favorites/${e.favoriteId}`,{headers:{Authorization:`Bearer ${t.userData.token}`}})}function z(){return n.get(`${t.API_URL}/favorites?user_id=${t.userData.data.id}&_relations=products`,{headers:{Authorization:`Bearer ${t.userData.token}`}})}function R(){return n.get(`${t.API_URL}/favorites?user_id=${t.userData.data.id}`,{headers:{Authorization:`Bearer ${t.userData.token}`}})}async function S(e,i){try{await B(e),e.isFavorite=!1,i&&(t.products=t.products.filter(s=>s.favoriteId!==e.favoriteId))}catch(s){console.error("Error: ",s.message)}}export{D as P,S as a,z as b,R as g,C as p,I as u};
